{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\MUsoftware\\\\Desktop\\\\project\\\\MUsoftware\\\\mudev.cc\\\\src\\\\ui\\\\page\\\\account\\\\modal\\\\nickIdChangeModal.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { refreshAccessTokenActionCreatorAsync } from 'src/redux/modules/account/action_creator';\nimport { Form, Modal, Button } from \"react-bootstrap\";\nimport { PHFormText } from 'src/ui/common/element/muFormText';\nimport { PHSpinnerButton } from 'src/ui/common/element/muButton';\nimport FrostAPI from 'src/network/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst calculateIncludedCharType = str => {\n  const strType = [];\n\n  for (let i = 0; i < str.length; i++) {\n    const currentChar = str.charAt(i);\n\n    if (currentChar >= '0' && currentChar <= '9') {\n      strType.push('n'); // number\n    } else if (currentChar >= 'a' && currentChar <= 'z') {\n      strType.push('l'); // lower\n    } else if (currentChar >= 'A' && currentChar <= 'Z') {\n      strType.push('u'); // upper\n    } else if (currentChar >= ' ' && currentChar <= '~') {\n      strType.push('s'); // special char\n    } else {\n      strType.push('e'); // error or unknown\n    }\n  }\n\n  return new Set(strType);\n};\n\nexport const AccountNickIDChangeModal = props => {\n  _s();\n\n  var _accountInfo$nick, _accountInfo$id;\n\n  const InputChecker = {\n    id: str => {\n      if (!str) {\n        return {\n          success: false,\n          idNotUsableReason: '새 아이디를 입력해주세요.'\n        };\n      } else if (str.length < 4) {\n        return {\n          success: false,\n          idNotUsableReason: '새 아이디의 길이가 너무 짧아요, 4자 이상으로 적어주세요.'\n        };\n      } else if (48 < str.length) {\n        return {\n          success: false,\n          idNotUsableReason: '새 아이디의 길이가 너무 길어요, 48자 이하로 적어주세요.'\n        };\n      }\n\n      const strType = calculateIncludedCharType(str);\n\n      if (strType.has('e') || strType.has('s')) {\n        return {\n          success: false,\n          idNotUsableReason: '새 아이디에 사용할 수 없는 글자가 포함되어 있어요,\\n공백, 특수문자 등을 빼고 다시 입력해주세요.'\n        };\n      }\n\n      return {\n        success: true,\n        idNotUsableReason: null\n      };\n    },\n    nick: str => {\n      if (!str) {\n        return {\n          success: false,\n          nickNotUsableReason: '별칭을 입력해주세요.'\n        };\n      }\n\n      return {\n        success: true,\n        nickNotUsableReason: null\n      };\n    }\n  };\n\n  const FrostErrorToAccountNickIdChangeError = err => {\n    if (!err) return {\n      nickIdChangeFailedReason: null\n    };\n    if (err.route !== 'account') return {\n      nickIdChangeFailedReason: null\n    }; // We need to set Frost's error message(showMsg)\n    // to proper (id|nick)NotUsableReason field or nickIdChangeFailedReason.\n\n    const errShowMsg = err.message;\n    const errFieldName = err.fieldName ? `${err.fieldName}NotUsableReason` : 'nickIdChangeFailedReason';\n    return {\n      [errFieldName]: errShowMsg\n    };\n  };\n\n  const accountInfo = useSelector(state => state.accountReducer);\n  const dispatch = useDispatch();\n  const navigate = useNavigate();\n  const [nickIdChangeModalState, setNickIdChangeModalState] = useState({\n    isProcessing: false,\n    nickTextFieldValue: (_accountInfo$nick = accountInfo.nick) !== null && _accountInfo$nick !== void 0 ? _accountInfo$nick : '',\n    nickNotUsableReason: '',\n    idTextFieldValue: (_accountInfo$id = accountInfo.id) !== null && _accountInfo$id !== void 0 ? _accountInfo$id : '',\n    idNotUsableReason: '',\n    nickIdChangeFailedReason: ''\n  }); // Reset form inputs when accountInfo changed or modal showed/disappeared.\n\n  useEffect(() => {\n    var _accountInfo$nick2, _accountInfo$id2;\n\n    return setNickIdChangeModalState({ ...nickIdChangeModalState,\n      nickTextFieldValue: (_accountInfo$nick2 = accountInfo.nick) !== null && _accountInfo$nick2 !== void 0 ? _accountInfo$nick2 : '',\n      nickNotUsableReason: '',\n      idTextFieldValue: (_accountInfo$id2 = accountInfo.id) !== null && _accountInfo$id2 !== void 0 ? _accountInfo$id2 : '',\n      idNotUsableReason: '',\n      nickIdChangeFailedReason: ''\n    });\n  }, [accountInfo, props.modalShowState]);\n\n  const closeModalFunc = () => {\n    if (!nickIdChangeModalState.isProcessing) props.setModalShowState(false);\n  };\n\n  const getTrimmedState = modalState => {\n    const tempModalState = { ...(modalState !== null && modalState !== void 0 ? modalState : nickIdChangeModalState)\n    };\n\n    for (const key in tempModalState) if (typeof tempModalState[key] === 'string') tempModalState[key] = tempModalState[key].trim();\n\n    return tempModalState;\n  };\n\n  const handleInputChange = fieldName => e => {\n    const fieldStateKey = `${fieldName}TextFieldValue`;\n    const fieldValue = e.target.type === 'checkbox' ? e.target.checked : e.target.value;\n    const checkerResult = InputChecker[fieldName](fieldValue.trim());\n    delete checkerResult.success;\n    setNickIdChangeModalState(prevState => ({ ...prevState,\n      ...checkerResult,\n      [fieldStateKey]: fieldValue\n    }));\n  };\n\n  const whatChanged = () => {\n    // Trim and test\n    const tempModalState = getTrimmedState();\n    return {\n      nick: tempModalState.nickTextFieldValue !== accountInfo.nick,\n      id: tempModalState.idTextFieldValue !== accountInfo.id\n    };\n  };\n\n  const getSubmitBtnText = () => {\n    const result = whatChanged();\n\n    if (result.id && result.nick) {\n      return '아이디 및 별칭 수정하기';\n    } else if (result.id) {\n      return '아이디 수정하기';\n    } else if (result.nick) {\n      return '별칭 수정하기';\n    } else {\n      return '수정된 정보가 없어요';\n    }\n  };\n\n  const shouldSubmitBtnDisabled = () => {\n    if (nickIdChangeModalState.isProcessing) return true;\n    const isChanged = whatChanged();\n    if (!isChanged.id && !isChanged.nick) return true;\n    const tempModalState = getTrimmedState();\n    let isFormCheckSuccess = true;\n    ['id', 'nick'].map(fieldName => {\n      const fieldValue = tempModalState[`${fieldName}TextFieldValue`];\n      const fieldCheckResult = InputChecker[fieldName](fieldValue);\n      if (isFormCheckSuccess) // It's OK to set true to false, but false to true must not be happened.\n        // And also, we are in a map function, so we cannot return directly here,\n        // we need to store the result somewhere outside of the function.\n        isFormCheckSuccess = fieldCheckResult.success;\n    });\n    return !isFormCheckSuccess;\n  };\n\n  const resetToOriginal = () => {\n    var _accountInfo$nick3, _accountInfo$id3;\n\n    setNickIdChangeModalState({ ...nickIdChangeModalState,\n      nickTextFieldValue: (_accountInfo$nick3 = accountInfo.nick) !== null && _accountInfo$nick3 !== void 0 ? _accountInfo$nick3 : '',\n      nickNotUsableReason: '',\n      idTextFieldValue: (_accountInfo$id3 = accountInfo.id) !== null && _accountInfo$id3 !== void 0 ? _accountInfo$id3 : '',\n      idNotUsableReason: ''\n    });\n  };\n\n  const tryAccountInfoChange = () => {\n    // Trim all strings in states\n    const tempModalState = getTrimmedState();\n    setNickIdChangeModalState(prevState => ({ ...prevState,\n      ...tempModalState,\n      isProcessing: true\n    }));\n    const isChanged = whatChanged();\n\n    if (!isChanged.id && !isChanged.nick) {\n      // Stats are not modified, just close it.\n      setNickIdChangeModalState(prevState => ({ ...prevState,\n        isProcessing: false\n      }));\n      return;\n    }\n\n    let isFormCheckSuccess = true;\n    let resultFormCheckData = {};\n    ['id', 'nick'].map(fieldName => {\n      const fieldValue = tempModalState[`${fieldName}TextFieldValue`];\n      const fieldCheckResult = InputChecker[fieldName](fieldValue);\n      if (isFormCheckSuccess) // It's OK to set true to false, but false to true must not be happened.\n        // And also, we are in a map function, so we cannot return directly here,\n        // we need to store the result somewhere outside of the function.\n        isFormCheckSuccess = fieldCheckResult.success;\n      resultFormCheckData = { ...resultFormCheckData,\n        ...fieldCheckResult\n      };\n    });\n    delete resultFormCheckData.success;\n    setNickIdChangeModalState(prevState => ({ ...prevState,\n      ...resultFormCheckData,\n      isProcessing: isFormCheckSuccess\n    }));\n    if (!isFormCheckSuccess) return;\n    new FrostAPI().modifyAccountInfo({ ...(isChanged.id ? {\n        id: tempModalState.idTextFieldValue\n      } : {}),\n      ...(isChanged.nick ? {\n        nickname: tempModalState.nickTextFieldValue\n      } : {})\n    }).then(() => {\n      setNickIdChangeModalState(prevState => ({ ...prevState,\n        isProcessing: false\n      }));\n      dispatch(refreshAccessTokenActionCreatorAsync());\n      closeModalFunc();\n    }).catch(reason => {\n      console.log(reason);\n      setNickIdChangeModalState(prevState => ({ ...prevState,\n        isProcessing: false,\n        ...FrostErrorToAccountNickIdChangeError(reason)\n      }));\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(Modal, {\n    show: props.modalShowState,\n    onHide: closeModalFunc,\n    backdrop: \"static\",\n    centered: true,\n    children: [/*#__PURE__*/_jsxDEV(Modal.Header, {\n      closeButton: true,\n      children: /*#__PURE__*/_jsxDEV(Modal.Title, {\n        children: /*#__PURE__*/_jsxDEV(\"h5\", {\n          style: {\n            margin: 0\n          },\n          children: \"\\uC544\\uC774\\uB514 \\uBC0F \\uBCC4\\uCE6D \\uBCC0\\uACBD\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 279,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 278,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 277,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Modal.Body, {\n      children: /*#__PURE__*/_jsxDEV(Form, {\n        onSubmit: evt => evt.preventDefault(),\n        children: [/*#__PURE__*/_jsxDEV(Form.Group, {\n          children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n            children: \"\\uC544\\uC774\\uB514\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 287,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n            type: \"text\",\n            placeholder: \"\\uC5EC\\uAE30\\uC5D0 \\uC0C8\\uB85C \\uC0AC\\uC6A9\\uD558\\uC2E4 \\uC544\\uC774\\uB514\\uB97C \\uC801\\uC5B4\\uC8FC\\uC138\\uC694.\",\n            disabled: nickIdChangeModalState.isProcessing,\n            value: nickIdChangeModalState.idTextFieldValue,\n            onChange: handleInputChange('id')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 288,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(PHFormText, {\n            children: nickIdChangeModalState.idNotUsableReason\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 294,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 286,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n          children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n            children: \"\\uBCC4\\uCE6D\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 298,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n            type: \"text\",\n            placeholder: \"\\uC5EC\\uAE30\\uC5D0 \\uC0C8\\uB85C \\uC0AC\\uC6A9\\uD558\\uC2E4 \\uBCC4\\uCE6D\\uC744 \\uC801\\uC5B4\\uC8FC\\uC138\\uC694.\",\n            disabled: nickIdChangeModalState.isProcessing,\n            value: nickIdChangeModalState.nickTextFieldValue,\n            onChange: handleInputChange('nick')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 299,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(PHFormText, {\n            children: nickIdChangeModalState.nickNotUsableReason\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 305,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 297,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(PHFormText, {\n          children: nickIdChangeModalState.nickIdChangeFailedReason\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 307,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 285,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 284,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Modal.Footer, {\n      children: [/*#__PURE__*/_jsxDEV(Button, {\n        variant: \"secondary\",\n        onClick: resetToOriginal,\n        disabled: nickIdChangeModalState.isProcessing,\n        children: \"\\uB418\\uB3CC\\uB9AC\\uAE30\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 311,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"secondary\",\n        onClick: closeModalFunc,\n        disabled: nickIdChangeModalState.isProcessing,\n        children: \"\\uCDE8\\uC18C\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 318,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(PHSpinnerButton, {\n        variant: \"primary\",\n        size: false,\n        style: {\n          margin: undefined\n        },\n        onClick: tryAccountInfoChange,\n        disabled: shouldSubmitBtnDisabled(),\n        showSpinner: nickIdChangeModalState.isProcessing,\n        children: getSubmitBtnText()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 325,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 310,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 272,\n    columnNumber: 12\n  }, this);\n};\n\n_s(AccountNickIDChangeModal, \"bIz0n87NhqYHZ0IohyR8sIIcA8Q=\", false, function () {\n  return [useSelector, useDispatch, useNavigate];\n});\n\n_c = AccountNickIDChangeModal;\n\nvar _c;\n\n$RefreshReg$(_c, \"AccountNickIDChangeModal\");","map":{"version":3,"sources":["C:/Users/MUsoftware/Desktop/project/MUsoftware/mudev.cc/src/ui/page/account/modal/nickIdChangeModal.tsx"],"names":["React","useState","useEffect","useNavigate","useSelector","useDispatch","refreshAccessTokenActionCreatorAsync","Form","Modal","Button","PHFormText","PHSpinnerButton","FrostAPI","calculateIncludedCharType","str","strType","i","length","currentChar","charAt","push","Set","AccountNickIDChangeModal","props","InputChecker","id","success","idNotUsableReason","has","nick","nickNotUsableReason","FrostErrorToAccountNickIdChangeError","err","nickIdChangeFailedReason","route","errShowMsg","message","errFieldName","fieldName","accountInfo","state","accountReducer","dispatch","navigate","nickIdChangeModalState","setNickIdChangeModalState","isProcessing","nickTextFieldValue","idTextFieldValue","modalShowState","closeModalFunc","setModalShowState","getTrimmedState","modalState","tempModalState","key","trim","handleInputChange","e","fieldStateKey","fieldValue","target","type","checked","value","checkerResult","prevState","whatChanged","getSubmitBtnText","result","shouldSubmitBtnDisabled","isChanged","isFormCheckSuccess","map","fieldCheckResult","resetToOriginal","tryAccountInfoChange","resultFormCheckData","modifyAccountInfo","nickname","then","catch","reason","console","log","margin","evt","preventDefault","undefined"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { refreshAccessTokenActionCreatorAsync } from 'src/redux/modules/account/action_creator';\r\nimport { isEmail } from 'validator';\r\n\r\nimport { Form, Modal, Button } from \"react-bootstrap\";\r\nimport { FrostError } from 'src/common/error';\r\n\r\nimport { PHFormText } from 'src/ui/common/element/muFormText';\r\nimport { PHSpinnerButton } from 'src/ui/common/element/muButton';\r\nimport { AccountInfo } from 'src/redux/modules/account/model';\r\nimport FrostAPI from 'src/network/api';\r\n\r\ninterface AccountNickIDChangeModalStateType {\r\n    isProcessing: boolean;\r\n\r\n    nickTextFieldValue: string;\r\n    nickNotUsableReason: string;\r\n    idTextFieldValue: string;\r\n    idNotUsableReason: string;\r\n    nickIdChangeFailedReason: string;\r\n}\r\n\r\nconst calculateIncludedCharType = (str: string) => {\r\n    const strType: string[] = [];\r\n\r\n    for (let i = 0; i < str.length; i++) {\r\n        const currentChar = str.charAt(i);\r\n        if (currentChar >= '0' && currentChar <= '9') {\r\n            strType.push('n'); // number\r\n        } else if (currentChar >= 'a' && currentChar <= 'z') {\r\n            strType.push('l'); // lower\r\n        } else if (currentChar >= 'A' && currentChar <= 'Z') {\r\n            strType.push('u'); // upper\r\n        } else if (currentChar >= ' ' && currentChar <= '~') {\r\n            strType.push('s'); // special char\r\n        } else {\r\n            strType.push('e'); // error or unknown\r\n        }\r\n    }\r\n    return new Set(strType);\r\n};\r\n\r\nexport const AccountNickIDChangeModal: React.FC = (props: {\r\n    modalShowState: boolean;\r\n    setModalShowState: (boolean) => void;\r\n}) => {\r\n    const InputChecker = {\r\n        id: (str: string) => {\r\n            if (!str) {\r\n                return {\r\n                    success: false,\r\n                    idNotUsableReason: '새 아이디를 입력해주세요.',\r\n                };\r\n            } else if (str.length < 4) {\r\n                return {\r\n                    success: false,\r\n                    idNotUsableReason: '새 아이디의 길이가 너무 짧아요, 4자 이상으로 적어주세요.',\r\n                };\r\n            } else if (48 < str.length) {\r\n                return {\r\n                    success: false,\r\n                    idNotUsableReason: '새 아이디의 길이가 너무 길어요, 48자 이하로 적어주세요.',\r\n                };\r\n            }\r\n\r\n            const strType = calculateIncludedCharType(str);\r\n            if (strType.has('e') || strType.has('s')) {\r\n                return {\r\n                    success: false,\r\n                    idNotUsableReason: '새 아이디에 사용할 수 없는 글자가 포함되어 있어요,\\n공백, 특수문자 등을 빼고 다시 입력해주세요.',\r\n                };\r\n            }\r\n\r\n            return { success: true, idNotUsableReason: null };\r\n        },\r\n        nick: (str: string) => {\r\n            if (!str) {\r\n                return {\r\n                    success: false,\r\n                    nickNotUsableReason: '별칭을 입력해주세요.',\r\n                };\r\n            }\r\n\r\n            return {\r\n                success: true,\r\n                nickNotUsableReason: null,\r\n            };\r\n        },\r\n    };\r\n    const FrostErrorToAccountNickIdChangeError = (err: FrostError) => {\r\n        if (!err)\r\n            return { nickIdChangeFailedReason: null };\r\n        if (err.route !== 'account')\r\n            return { nickIdChangeFailedReason: null };\r\n        // We need to set Frost's error message(showMsg)\r\n        // to proper (id|nick)NotUsableReason field or nickIdChangeFailedReason.\r\n        const errShowMsg = err.message;\r\n        const errFieldName = (err.fieldName) ? `${err.fieldName}NotUsableReason` : 'nickIdChangeFailedReason';\r\n\r\n        return { [errFieldName]: errShowMsg, };\r\n    };\r\n\r\n    const accountInfo: AccountInfo = useSelector(state => state.accountReducer);\r\n    const dispatch = useDispatch();\r\n    const navigate = useNavigate();\r\n    const [nickIdChangeModalState, setNickIdChangeModalState] = useState({\r\n        isProcessing: false,\r\n\r\n        nickTextFieldValue: accountInfo.nick ?? '',\r\n        nickNotUsableReason: '',\r\n        idTextFieldValue: accountInfo.id ?? '',\r\n        idNotUsableReason: '',\r\n        nickIdChangeFailedReason: '',\r\n    });\r\n    // Reset form inputs when accountInfo changed or modal showed/disappeared.\r\n    useEffect(() => setNickIdChangeModalState({\r\n        ...nickIdChangeModalState,\r\n        nickTextFieldValue: accountInfo.nick ?? '',\r\n        nickNotUsableReason: '',\r\n        idTextFieldValue: accountInfo.id ?? '',\r\n        idNotUsableReason: '',\r\n        nickIdChangeFailedReason: '',\r\n    }), [accountInfo, props.modalShowState]);\r\n\r\n    const closeModalFunc = () => {\r\n        if (!nickIdChangeModalState.isProcessing)\r\n            props.setModalShowState(false);\r\n    };\r\n\r\n    const getTrimmedState = (modalState?: AccountNickIDChangeModalStateType) => {\r\n        const tempModalState: AccountNickIDChangeModalStateType = { ...(modalState ?? nickIdChangeModalState), };\r\n        for (const key in tempModalState)\r\n            if (typeof (tempModalState[key]) === 'string')\r\n                tempModalState[key] = tempModalState[key].trim();\r\n\r\n        return tempModalState;\r\n    };\r\n    const handleInputChange = (fieldName: string) => (e: Event) => {\r\n        const fieldStateKey = `${fieldName}TextFieldValue`;\r\n        const fieldValue = (e.target.type === 'checkbox') ? e.target.checked : e.target.value;\r\n\r\n        const checkerResult = InputChecker[fieldName](fieldValue.trim());\r\n        delete (checkerResult.success);\r\n\r\n        setNickIdChangeModalState((prevState) => ({\r\n            ...prevState,\r\n            ...checkerResult,\r\n            [fieldStateKey]: fieldValue,\r\n        }));\r\n    };\r\n\r\n    const whatChanged = () => {\r\n        // Trim and test\r\n        const tempModalState = getTrimmedState();\r\n        return {\r\n            nick: tempModalState.nickTextFieldValue !== accountInfo.nick,\r\n            id: tempModalState.idTextFieldValue !== accountInfo.id\r\n        };\r\n    };\r\n    const getSubmitBtnText = () => {\r\n        const result = whatChanged();\r\n        if (result.id && result.nick) {\r\n            return '아이디 및 별칭 수정하기';\r\n        } else if (result.id) {\r\n            return '아이디 수정하기';\r\n        } else if (result.nick) {\r\n            return '별칭 수정하기';\r\n        } else {\r\n            return '수정된 정보가 없어요';\r\n        }\r\n    };\r\n    const shouldSubmitBtnDisabled = () => {\r\n        if (nickIdChangeModalState.isProcessing)\r\n            return true;\r\n\r\n        const isChanged = whatChanged();\r\n        if (!isChanged.id && !isChanged.nick)\r\n            return true;\r\n\r\n        const tempModalState = getTrimmedState();\r\n        let isFormCheckSuccess = true;\r\n        ['id', 'nick'].map(fieldName => {\r\n            const fieldValue: string = tempModalState[`${fieldName}TextFieldValue`];\r\n            const fieldCheckResult: string = InputChecker[fieldName](fieldValue);\r\n\r\n            if (isFormCheckSuccess)\r\n                // It's OK to set true to false, but false to true must not be happened.\r\n                // And also, we are in a map function, so we cannot return directly here,\r\n                // we need to store the result somewhere outside of the function.\r\n                isFormCheckSuccess = fieldCheckResult.success;\r\n        });\r\n\r\n        return !isFormCheckSuccess;\r\n    };\r\n\r\n    const resetToOriginal = () => {\r\n        setNickIdChangeModalState({\r\n            ...nickIdChangeModalState,\r\n            nickTextFieldValue: accountInfo.nick ?? '',\r\n            nickNotUsableReason: '',\r\n            idTextFieldValue: accountInfo.id ?? '',\r\n            idNotUsableReason: '',\r\n        });\r\n    };\r\n    const tryAccountInfoChange = () => {\r\n        // Trim all strings in states\r\n        const tempModalState = getTrimmedState();\r\n        setNickIdChangeModalState(prevState => ({\r\n            ...prevState,\r\n            ...tempModalState,\r\n            isProcessing: true,\r\n        }));\r\n\r\n        const isChanged = whatChanged();\r\n        if (!isChanged.id && !isChanged.nick) {\r\n            // Stats are not modified, just close it.\r\n            setNickIdChangeModalState(prevState => ({\r\n                ...prevState,\r\n                isProcessing: false,\r\n            }));\r\n            return;\r\n        }\r\n\r\n        let isFormCheckSuccess = true;\r\n        let resultFormCheckData = {};\r\n        ['id', 'nick'].map(fieldName => {\r\n            const fieldValue = tempModalState[`${fieldName}TextFieldValue`];\r\n            const fieldCheckResult = InputChecker[fieldName](fieldValue);\r\n\r\n            if (isFormCheckSuccess)\r\n                // It's OK to set true to false, but false to true must not be happened.\r\n                // And also, we are in a map function, so we cannot return directly here,\r\n                // we need to store the result somewhere outside of the function.\r\n                isFormCheckSuccess = fieldCheckResult.success;\r\n\r\n            resultFormCheckData = { ...resultFormCheckData, ...fieldCheckResult };\r\n        });\r\n        delete (resultFormCheckData.success);\r\n\r\n        setNickIdChangeModalState(prevState => ({\r\n            ...prevState,\r\n            ...resultFormCheckData,\r\n            isProcessing: isFormCheckSuccess,\r\n        }));\r\n\r\n        if (!isFormCheckSuccess)\r\n            return;\r\n\r\n        (new FrostAPI())\r\n            .modifyAccountInfo({\r\n                ...((isChanged.id) ? { id: tempModalState.idTextFieldValue, } : {}),\r\n                ...((isChanged.nick) ? { nickname: tempModalState.nickTextFieldValue, } : {}),\r\n            })\r\n            .then(() => {\r\n                setNickIdChangeModalState(prevState => ({ ...prevState, isProcessing: false, }));\r\n                dispatch(refreshAccessTokenActionCreatorAsync());\r\n                closeModalFunc();\r\n            })\r\n            .catch((reason: FrostError) => {\r\n                console.log(reason);\r\n                setNickIdChangeModalState(prevState => ({\r\n                    ...prevState,\r\n                    isProcessing: false,\r\n                    ...FrostErrorToAccountNickIdChangeError(reason),\r\n                }));\r\n            });\r\n\r\n    };\r\n\r\n    return <Modal\r\n        show={props.modalShowState}\r\n        onHide={closeModalFunc}\r\n        backdrop='static'\r\n        centered >\r\n        <Modal.Header closeButton>\r\n            <Modal.Title>\r\n                <h5 style={{ margin: 0, }}>\r\n                    아이디 및 별칭 변경\r\n                </h5>\r\n            </Modal.Title>\r\n        </Modal.Header>\r\n        <Modal.Body>\r\n            <Form onSubmit={evt => evt.preventDefault()}>\r\n                <Form.Group>\r\n                    <Form.Label>아이디</Form.Label>\r\n                    <Form.Control\r\n                        type='text'\r\n                        placeholder='여기에 새로 사용하실 아이디를 적어주세요.'\r\n                        disabled={nickIdChangeModalState.isProcessing}\r\n                        value={nickIdChangeModalState.idTextFieldValue}\r\n                        onChange={handleInputChange('id')} />\r\n                    <PHFormText>{nickIdChangeModalState.idNotUsableReason}</PHFormText>\r\n                </Form.Group>\r\n\r\n                <Form.Group>\r\n                    <Form.Label>별칭</Form.Label>\r\n                    <Form.Control\r\n                        type='text'\r\n                        placeholder='여기에 새로 사용하실 별칭을 적어주세요.'\r\n                        disabled={nickIdChangeModalState.isProcessing}\r\n                        value={nickIdChangeModalState.nickTextFieldValue}\r\n                        onChange={handleInputChange('nick')} />\r\n                    <PHFormText>{nickIdChangeModalState.nickNotUsableReason}</PHFormText>\r\n                </Form.Group>\r\n                <PHFormText>{nickIdChangeModalState.nickIdChangeFailedReason}</PHFormText>\r\n            </Form>\r\n        </Modal.Body>\r\n        <Modal.Footer>\r\n            <Button\r\n                variant='secondary'\r\n                onClick={resetToOriginal}\r\n                disabled={nickIdChangeModalState.isProcessing}>\r\n                되돌리기\r\n            </Button>\r\n\r\n            <Button\r\n                variant='secondary'\r\n                onClick={closeModalFunc}\r\n                disabled={nickIdChangeModalState.isProcessing}>\r\n                취소\r\n            </Button>\r\n\r\n            <PHSpinnerButton\r\n                variant='primary'\r\n                size={false}\r\n                style={{ margin: undefined }}\r\n                onClick={tryAccountInfoChange}\r\n                disabled={shouldSubmitBtnDisabled()}\r\n                showSpinner={nickIdChangeModalState.isProcessing}>\r\n                {getSubmitBtnText()}\r\n            </PHSpinnerButton>\r\n        </Modal.Footer>\r\n    </Modal>;\r\n};\r\n"]},"metadata":{},"sourceType":"module"}