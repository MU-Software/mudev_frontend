{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\MUsoftware\\\\Desktop\\\\project\\\\MUsoftware\\\\mudev.cc\\\\src\\\\ui\\\\page\\\\playco\\\\element\\\\playlistControlModal.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { Form, Modal, Button } from \"react-bootstrap\";\nimport { PHFormText } from 'src/ui/common/element/muFormText';\nimport { PHSpinnerButton } from 'src/ui/common/element/muButton';\nimport { PlaylistConfig } from '../playco/model';\nimport { PlayCoAPI } from '../playco/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const PlaylistControlModal = props => {\n  _s();\n\n  var _props$initialModalSt, _props$initialModalSt2, _props$initialModalSt3, _props$initialModalSt4, _props$initialModalSt5, _props$initialModalSt6, _props$initialModalSt7, _props$initialModalSt8, _props$initialModalSt9, _props$initialModalSt10;\n\n  const navigate = useNavigate();\n  const [playlistControlModalState, setPlaylistControlModalState] = useState({\n    isProcessing: false,\n    nameTextFieldValue: (_props$initialModalSt = (_props$initialModalSt2 = props.initialModalState) === null || _props$initialModalSt2 === void 0 ? void 0 : _props$initialModalSt2.name) !== null && _props$initialModalSt !== void 0 ? _props$initialModalSt : '',\n    nameNotUsableReason: '',\n    isAllowingDuplicate: (_props$initialModalSt3 = (_props$initialModalSt4 = props.initialModalState) === null || _props$initialModalSt4 === void 0 ? void 0 : _props$initialModalSt4.allow_duplicate) !== null && _props$initialModalSt3 !== void 0 ? _props$initialModalSt3 : true,\n    isPublicAccessable: (_props$initialModalSt5 = (_props$initialModalSt6 = props.initialModalState) === null || _props$initialModalSt6 === void 0 ? void 0 : _props$initialModalSt6.public_accessable) !== null && _props$initialModalSt5 !== void 0 ? _props$initialModalSt5 : false,\n    isPublicItemAppendable: (_props$initialModalSt7 = (_props$initialModalSt8 = props.initialModalState) === null || _props$initialModalSt8 === void 0 ? void 0 : _props$initialModalSt8.public_item_appendable) !== null && _props$initialModalSt7 !== void 0 ? _props$initialModalSt7 : false,\n    isPublicItemDeletable: (_props$initialModalSt9 = (_props$initialModalSt10 = props.initialModalState) === null || _props$initialModalSt10 === void 0 ? void 0 : _props$initialModalSt10.public_item_deletable) !== null && _props$initialModalSt9 !== void 0 ? _props$initialModalSt9 : false,\n    playlistCreationFailedReason: ''\n  });\n  useEffect(() => {\n    var _props$initialModalSt11, _props$initialModalSt12, _props$initialModalSt13, _props$initialModalSt14, _props$initialModalSt15, _props$initialModalSt16, _props$initialModalSt17, _props$initialModalSt18, _props$initialModalSt19, _props$initialModalSt20;\n\n    return setPlaylistControlModalState({ ...playlistControlModalState,\n      nameTextFieldValue: (_props$initialModalSt11 = (_props$initialModalSt12 = props.initialModalState) === null || _props$initialModalSt12 === void 0 ? void 0 : _props$initialModalSt12.name) !== null && _props$initialModalSt11 !== void 0 ? _props$initialModalSt11 : '',\n      nameNotUsableReason: '',\n      isAllowingDuplicate: (_props$initialModalSt13 = (_props$initialModalSt14 = props.initialModalState) === null || _props$initialModalSt14 === void 0 ? void 0 : _props$initialModalSt14.allow_duplicate) !== null && _props$initialModalSt13 !== void 0 ? _props$initialModalSt13 : true,\n      isPublicAccessable: (_props$initialModalSt15 = (_props$initialModalSt16 = props.initialModalState) === null || _props$initialModalSt16 === void 0 ? void 0 : _props$initialModalSt16.public_accessable) !== null && _props$initialModalSt15 !== void 0 ? _props$initialModalSt15 : false,\n      isPublicItemAppendable: (_props$initialModalSt17 = (_props$initialModalSt18 = props.initialModalState) === null || _props$initialModalSt18 === void 0 ? void 0 : _props$initialModalSt18.public_item_appendable) !== null && _props$initialModalSt17 !== void 0 ? _props$initialModalSt17 : false,\n      isPublicItemDeletable: (_props$initialModalSt19 = (_props$initialModalSt20 = props.initialModalState) === null || _props$initialModalSt20 === void 0 ? void 0 : _props$initialModalSt20.public_item_deletable) !== null && _props$initialModalSt19 !== void 0 ? _props$initialModalSt19 : false,\n      playlistCreationFailedReason: ''\n    });\n  }, [props.initialModalState]);\n\n  const currentStateToPlaylistConfig = () => new PlaylistConfig({\n    name: playlistControlModalState.nameTextFieldValue,\n    allow_duplicate: playlistControlModalState.isAllowingDuplicate,\n    public_accessable: playlistControlModalState.isPublicAccessable,\n    public_item_appendable: playlistControlModalState.isPublicItemAppendable,\n    public_item_deletable: playlistControlModalState.isPublicItemDeletable\n  });\n\n  const closeModalFunc = () => {\n    if (!playlistControlModalState.isProcessing) props.setModalShowState(false);\n  };\n\n  const handleInputChange = valueName => e => {\n    const newModalState = { ...playlistControlModalState,\n      [valueName]: e.target.type === 'checkbox' ? e.target.checked : e.target.value\n    };\n    if (valueName === 'nameTextFieldValue') newModalState.nameNotUsableReason = '';\n    setPlaylistControlModalState(newModalState);\n  };\n\n  const tryPlaylistCreate = () => {\n    let isRequestable = true;\n    let newModalState = { ...playlistControlModalState,\n      isProcessing: true\n    }; // trim all strings in states\n\n    for (const key in newModalState) if (typeof newModalState[key] === 'string') newModalState[key] = newModalState[key].trim();\n\n    if (!newModalState.nameTextFieldValue) {\n      newModalState.nameNotUsableReason = '재생목록 이름을 적어주세요!';\n      newModalState.isProcessing = false;\n      isRequestable = false;\n    }\n\n    setPlaylistControlModalState(newModalState);\n\n    if (isRequestable) {\n      PlayCoAPI.createPlaylist(currentStateToPlaylistConfig()).then(response => {\n        if (!response.success) {\n          let errorMsg = '';\n\n          switch (response.subCode) {\n            case 'resource.unique_failed':\n              errorMsg = '계정 당 5개의 재생목록만 만드실 수 있어요, 기존의 재생목록을 지워주세요.';\n              break;\n\n            default:\n              errorMsg = '알 수 없는 문제가 생겼어요, 10분 후에 다시 시도해주세요.';\n              break;\n          }\n\n          newModalState = { ...newModalState,\n            playlistCreationFailedReason: errorMsg,\n            isProcessing: false\n          };\n          setPlaylistControlModalState(newModalState);\n        } else {\n          newModalState = { ...newModalState,\n            playlistCreationFailedReason: '',\n            isProcessing: false\n          };\n          setPlaylistControlModalState(newModalState);\n          closeModalFunc();\n        }\n      }, reason => {\n        newModalState = { ...newModalState,\n          playlistCreationFailedReason: reason.message,\n          isProcessing: false\n        };\n        setPlaylistControlModalState(newModalState);\n      });\n    }\n  };\n\n  const tryPlaylistModify = () => {//\n  };\n\n  return /*#__PURE__*/_jsxDEV(Modal, {\n    show: props.modalShowState,\n    onHide: closeModalFunc,\n    backdrop: \"static\",\n    keyboard: false,\n    centered: true,\n    children: [/*#__PURE__*/_jsxDEV(Modal.Header, {\n      closeButton: true,\n      children: /*#__PURE__*/_jsxDEV(Modal.Title, {\n        children: /*#__PURE__*/_jsxDEV(\"h5\", {\n          style: {\n            margin: 0\n          },\n          children: props.createMode ? '재생목록 만들기' : '재생목록 수정'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 9\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(Modal.Body, {\n      children: /*#__PURE__*/_jsxDEV(Form, {\n        children: [/*#__PURE__*/_jsxDEV(Form.Group, {\n          children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n            children: \"\\uC7AC\\uC0DD\\uBAA9\\uB85D \\uC774\\uB984\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 139,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n            type: \"text\",\n            placeholder: props.createMode ? '여기에 새로 만드실 재생목록의 이름을 적어주세요' : '여기에 이 재생목록의 새 이름을 적어주세요',\n            disabled: playlistControlModalState.isProcessing,\n            value: playlistControlModalState.nameTextFieldValue,\n            onChange: handleInputChange('nameTextFieldValue')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 140,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(PHFormText, {\n            children: playlistControlModalState.nameNotUsableReason\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 150,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n          children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n            children: \"\\uC7AC\\uC0DD\\uBAA9\\uB85D \\uC124\\uC815\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 153,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(Form.Switch, {\n            onChange: handleInputChange('isAllowingDuplicate'),\n            checked: playlistControlModalState.isAllowingDuplicate,\n            disabled: playlistControlModalState.isProcessing,\n            id: \"isAllowingDuplicateSwitch\",\n            label: `중복되는 영상을 추가할 수 ${playlistControlModalState.isAllowingDuplicate ? '있어요' : '없어요'}.`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 154,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(Form.Switch, {\n            onChange: handleInputChange('isPublicAccessable'),\n            checked: playlistControlModalState.isPublicAccessable,\n            disabled: playlistControlModalState.isProcessing,\n            id: \"isPublicAccessableSwitch\",\n            label: `다른 사람이 재생목록을 볼 수 ${playlistControlModalState.isPublicAccessable ? '있어요' : '없어요'}.`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 160,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(Form.Switch, {\n            onChange: handleInputChange('isPublicItemAppendable'),\n            checked: playlistControlModalState.isPublicItemAppendable,\n            disabled: playlistControlModalState.isProcessing,\n            id: \"isPublicItemAppendableSwitch\",\n            label: `다른 사람이 재생목록에 영상을 추가할 수 ${playlistControlModalState.isPublicItemAppendable ? '있어요' : '없어요'}.`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 166,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(Form.Switch, {\n            onChange: handleInputChange('isPublicItemDeletable'),\n            checked: playlistControlModalState.isPublicItemDeletable,\n            disabled: playlistControlModalState.isProcessing,\n            id: \"isPublicItemDeletableSwitch\",\n            label: `다른 사람이 재생목록에서 영상을 삭제할 수 ${playlistControlModalState.isPublicItemDeletable ? '있어요' : '없어요'}.`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 172,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(PHFormText, {\n          children: playlistControlModalState.playlistCreationFailedReason\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(Modal.Footer, {\n      children: [/*#__PURE__*/_jsxDEV(Button, {\n        variant: \"secondary\",\n        onClick: closeModalFunc,\n        disabled: playlistControlModalState.isProcessing,\n        children: \"\\uCDE8\\uC18C\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(PHSpinnerButton, {\n        variant: \"primary\",\n        size: false,\n        style: {\n          margin: undefined\n        },\n        onClick: props.createMode ? tryPlaylistCreate : tryPlaylistModify,\n        showSpinner: playlistControlModalState.isProcessing,\n        children: props.createMode ? '재생목록 만들기' : '재생목록 수정'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 123,\n    columnNumber: 10\n  }, this);\n};\n\n_s(PlaylistControlModal, \"ohxMeuDSpL1ALCYNgOsOtKa8HIo=\", false, function () {\n  return [useNavigate];\n});\n\n_c = PlaylistControlModal;\n\nvar _c;\n\n$RefreshReg$(_c, \"PlaylistControlModal\");","map":{"version":3,"sources":["C:/Users/MUsoftware/Desktop/project/MUsoftware/mudev.cc/src/ui/page/playco/element/playlistControlModal.tsx"],"names":["React","useState","useEffect","useNavigate","Form","Modal","Button","PHFormText","PHSpinnerButton","PlaylistConfig","PlayCoAPI","PlaylistControlModal","props","navigate","playlistControlModalState","setPlaylistControlModalState","isProcessing","nameTextFieldValue","initialModalState","name","nameNotUsableReason","isAllowingDuplicate","allow_duplicate","isPublicAccessable","public_accessable","isPublicItemAppendable","public_item_appendable","isPublicItemDeletable","public_item_deletable","playlistCreationFailedReason","currentStateToPlaylistConfig","closeModalFunc","setModalShowState","handleInputChange","valueName","e","newModalState","target","type","checked","value","tryPlaylistCreate","isRequestable","key","trim","createPlaylist","then","response","success","errorMsg","subCode","reason","message","tryPlaylistModify","modalShowState","margin","createMode","undefined"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { Form, Modal, Button } from \"react-bootstrap\";\r\nimport { FrostError } from 'src/common/error';\r\n\r\nimport { PHFormText } from 'src/ui/common/element/muFormText';\r\nimport { PHSpinnerButton } from 'src/ui/common/element/muButton';\r\nimport { PlaylistConfig } from '../playco/model';\r\nimport { PlayCoAPI } from '../playco/api';\r\n\r\nexport const PlaylistControlModal: React.FC = (props: {\r\n  modalShowState: boolean;\r\n  setModalShowState: (boolean) => void;\r\n  createMode?: boolean;\r\n  initialModalState?: Playlist;\r\n}) => {\r\n  const navigate = useNavigate();\r\n  const [playlistControlModalState, setPlaylistControlModalState] = useState({\r\n    isProcessing: false,\r\n\r\n    nameTextFieldValue: props.initialModalState?.name ?? '',\r\n    nameNotUsableReason: '',\r\n    isAllowingDuplicate: props.initialModalState?.allow_duplicate ?? true,\r\n    isPublicAccessable: props.initialModalState?.public_accessable ?? false,\r\n    isPublicItemAppendable: props.initialModalState?.public_item_appendable ?? false,\r\n    isPublicItemDeletable: props.initialModalState?.public_item_deletable ?? false,\r\n    playlistCreationFailedReason: '',\r\n  });\r\n  useEffect(() => setPlaylistControlModalState({\r\n    ...playlistControlModalState,\r\n    nameTextFieldValue: props.initialModalState?.name ?? '',\r\n    nameNotUsableReason: '',\r\n    isAllowingDuplicate: props.initialModalState?.allow_duplicate ?? true,\r\n    isPublicAccessable: props.initialModalState?.public_accessable ?? false,\r\n    isPublicItemAppendable: props.initialModalState?.public_item_appendable ?? false,\r\n    isPublicItemDeletable: props.initialModalState?.public_item_deletable ?? false,\r\n    playlistCreationFailedReason: '',\r\n  }), [props.initialModalState]);\r\n  const currentStateToPlaylistConfig = () => new PlaylistConfig({\r\n    name: playlistControlModalState.nameTextFieldValue,\r\n    allow_duplicate: playlistControlModalState.isAllowingDuplicate,\r\n    public_accessable: playlistControlModalState.isPublicAccessable,\r\n    public_item_appendable: playlistControlModalState.isPublicItemAppendable,\r\n    public_item_deletable: playlistControlModalState.isPublicItemDeletable,\r\n  });\r\n  const closeModalFunc = () => {\r\n    if (!playlistControlModalState.isProcessing)\r\n      props.setModalShowState(false);\r\n  };\r\n  const handleInputChange = (valueName) => (e) => {\r\n    const newModalState = {\r\n      ...playlistControlModalState,\r\n      [valueName]: (e.target.type === 'checkbox') ? e.target.checked : e.target.value,\r\n    };\r\n    if (valueName === 'nameTextFieldValue')\r\n      newModalState.nameNotUsableReason = '';\r\n    setPlaylistControlModalState(newModalState);\r\n  }\r\n  const tryPlaylistCreate = () => {\r\n    let isRequestable = true;\r\n    let newModalState = {\r\n      ...playlistControlModalState,\r\n      isProcessing: true,\r\n    };\r\n\r\n    // trim all strings in states\r\n    for (const key in newModalState)\r\n      if (typeof (newModalState[key]) === 'string')\r\n        newModalState[key] = newModalState[key].trim();\r\n\r\n    if (!newModalState.nameTextFieldValue) {\r\n      newModalState.nameNotUsableReason = '재생목록 이름을 적어주세요!';\r\n      newModalState.isProcessing = false;\r\n      isRequestable = false;\r\n    }\r\n    setPlaylistControlModalState(newModalState);\r\n\r\n    if (isRequestable) {\r\n      PlayCoAPI\r\n        .createPlaylist(currentStateToPlaylistConfig())\r\n        .then(\r\n          (response) => {\r\n            if (!response.success) {\r\n              let errorMsg = '';\r\n              switch (response.subCode) {\r\n                case 'resource.unique_failed':\r\n                  errorMsg = '계정 당 5개의 재생목록만 만드실 수 있어요, 기존의 재생목록을 지워주세요.';\r\n                  break;\r\n                default:\r\n                  errorMsg = '알 수 없는 문제가 생겼어요, 10분 후에 다시 시도해주세요.';\r\n                  break;\r\n              }\r\n\r\n              newModalState = {\r\n                ...newModalState,\r\n                playlistCreationFailedReason: errorMsg,\r\n                isProcessing: false,\r\n              }\r\n              setPlaylistControlModalState(newModalState);\r\n            } else {\r\n              newModalState = {\r\n                ...newModalState,\r\n                playlistCreationFailedReason: '',\r\n                isProcessing: false,\r\n              }\r\n              setPlaylistControlModalState(newModalState);\r\n              closeModalFunc();\r\n            }\r\n          },\r\n          (reason: FrostError) => {\r\n            newModalState = {\r\n              ...newModalState,\r\n              playlistCreationFailedReason: reason.message,\r\n              isProcessing: false,\r\n            }\r\n            setPlaylistControlModalState(newModalState);\r\n          });\r\n    }\r\n  }\r\n  const tryPlaylistModify = () => {\r\n    //\r\n  }\r\n  return <Modal\r\n    show={props.modalShowState}\r\n    onHide={closeModalFunc}\r\n    backdrop='static'\r\n    keyboard={false}\r\n    centered >\r\n    <Modal.Header closeButton>\r\n      <Modal.Title>\r\n        <h5 style={{ margin: 0, }}>\r\n          {(props.createMode) ? '재생목록 만들기' : '재생목록 수정'}\r\n        </h5>\r\n      </Modal.Title>\r\n    </Modal.Header>\r\n    <Modal.Body>\r\n      <Form>\r\n        <Form.Group>\r\n          <Form.Label>재생목록 이름</Form.Label>\r\n          <Form.Control\r\n            type='text'\r\n            placeholder={\r\n              (props.createMode)\r\n                ? '여기에 새로 만드실 재생목록의 이름을 적어주세요'\r\n                : '여기에 이 재생목록의 새 이름을 적어주세요'\r\n            }\r\n            disabled={playlistControlModalState.isProcessing}\r\n            value={playlistControlModalState.nameTextFieldValue}\r\n            onChange={handleInputChange('nameTextFieldValue')} />\r\n          <PHFormText>{playlistControlModalState.nameNotUsableReason}</PHFormText>\r\n        </Form.Group>\r\n        <Form.Group>\r\n          <Form.Label>재생목록 설정</Form.Label>\r\n          <Form.Switch\r\n            onChange={handleInputChange('isAllowingDuplicate')}\r\n            checked={playlistControlModalState.isAllowingDuplicate}\r\n            disabled={playlistControlModalState.isProcessing}\r\n            id='isAllowingDuplicateSwitch'\r\n            label={`중복되는 영상을 추가할 수 ${(playlistControlModalState.isAllowingDuplicate) ? '있어요' : '없어요'}.`} />\r\n          <Form.Switch\r\n            onChange={handleInputChange('isPublicAccessable')}\r\n            checked={playlistControlModalState.isPublicAccessable}\r\n            disabled={playlistControlModalState.isProcessing}\r\n            id='isPublicAccessableSwitch'\r\n            label={`다른 사람이 재생목록을 볼 수 ${(playlistControlModalState.isPublicAccessable) ? '있어요' : '없어요'}.`} />\r\n          <Form.Switch\r\n            onChange={handleInputChange('isPublicItemAppendable')}\r\n            checked={playlistControlModalState.isPublicItemAppendable}\r\n            disabled={playlistControlModalState.isProcessing}\r\n            id='isPublicItemAppendableSwitch'\r\n            label={`다른 사람이 재생목록에 영상을 추가할 수 ${(playlistControlModalState.isPublicItemAppendable) ? '있어요' : '없어요'}.`} />\r\n          <Form.Switch\r\n            onChange={handleInputChange('isPublicItemDeletable')}\r\n            checked={playlistControlModalState.isPublicItemDeletable}\r\n            disabled={playlistControlModalState.isProcessing}\r\n            id='isPublicItemDeletableSwitch'\r\n            label={`다른 사람이 재생목록에서 영상을 삭제할 수 ${(playlistControlModalState.isPublicItemDeletable) ? '있어요' : '없어요'}.`} />\r\n        </Form.Group>\r\n        <PHFormText>{playlistControlModalState.playlistCreationFailedReason}</PHFormText>\r\n      </Form>\r\n    </Modal.Body>\r\n    <Modal.Footer>\r\n      <Button\r\n        variant='secondary'\r\n        onClick={closeModalFunc}\r\n        disabled={playlistControlModalState.isProcessing}>\r\n        취소\r\n      </Button>\r\n\r\n      <PHSpinnerButton\r\n        variant='primary'\r\n        size={false}\r\n        style={{ margin: undefined }}\r\n        onClick={(props.createMode) ? tryPlaylistCreate : tryPlaylistModify}\r\n        showSpinner={playlistControlModalState.isProcessing}>\r\n        {(props.createMode) ? '재생목록 만들기' : '재생목록 수정'}\r\n      </PHSpinnerButton>\r\n    </Modal.Footer>\r\n  </Modal>;\r\n}\r\n"]},"metadata":{},"sourceType":"module"}