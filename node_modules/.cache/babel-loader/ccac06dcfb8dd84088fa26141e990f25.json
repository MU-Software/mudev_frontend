{"ast":null,"code":"import _defineProperty from\"C:/Users/MUsoftware/Desktop/project/MUsoftware/mudev.cc/.yarn/cache/@babel-runtime-npm-7.12.1-b069f70b16-fb4b4c8f70.zip/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"C:/Users/MUsoftware/Desktop/project/MUsoftware/mudev.cc/.yarn/cache/@babel-runtime-npm-7.12.1-b069f70b16-fb4b4c8f70.zip/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:/Users/MUsoftware/Desktop/project/MUsoftware/mudev.cc/.yarn/cache/@babel-runtime-npm-7.12.1-b069f70b16-fb4b4c8f70.zip/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import{Form,Modal,Button}from\"react-bootstrap\";import{PHFormText}from'src/ui/common/element/muFormText';import{PHSpinnerButton}from'src/ui/common/element/muButton';import{PlaylistConfig}from'../playco/model';import{PlayCoAPI}from'../playco/api';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var PlaylistControlModal=function PlaylistControlModal(props){var _props$initialModalSt,_props$initialModalSt2,_props$initialModalSt3,_props$initialModalSt4,_props$initialModalSt5,_props$initialModalSt6,_props$initialModalSt7,_props$initialModalSt8,_props$initialModalSt9,_props$initialModalSt10;var navigate=useNavigate();var _useState=useState({isProcessing:false,nameTextFieldValue:(_props$initialModalSt=(_props$initialModalSt2=props.initialModalState)===null||_props$initialModalSt2===void 0?void 0:_props$initialModalSt2.name)!==null&&_props$initialModalSt!==void 0?_props$initialModalSt:'',nameNotUsableReason:'',isAllowingDuplicate:(_props$initialModalSt3=(_props$initialModalSt4=props.initialModalState)===null||_props$initialModalSt4===void 0?void 0:_props$initialModalSt4.allow_duplicate)!==null&&_props$initialModalSt3!==void 0?_props$initialModalSt3:true,isPublicAccessable:(_props$initialModalSt5=(_props$initialModalSt6=props.initialModalState)===null||_props$initialModalSt6===void 0?void 0:_props$initialModalSt6.public_accessable)!==null&&_props$initialModalSt5!==void 0?_props$initialModalSt5:false,isPublicItemAppendable:(_props$initialModalSt7=(_props$initialModalSt8=props.initialModalState)===null||_props$initialModalSt8===void 0?void 0:_props$initialModalSt8.public_item_appendable)!==null&&_props$initialModalSt7!==void 0?_props$initialModalSt7:false,isPublicItemDeletable:(_props$initialModalSt9=(_props$initialModalSt10=props.initialModalState)===null||_props$initialModalSt10===void 0?void 0:_props$initialModalSt10.public_item_deletable)!==null&&_props$initialModalSt9!==void 0?_props$initialModalSt9:false,playlistCreationFailedReason:''}),_useState2=_slicedToArray(_useState,2),playlistControlModalState=_useState2[0],setPlaylistControlModalState=_useState2[1];useEffect(function(){var _props$initialModalSt11,_props$initialModalSt12,_props$initialModalSt13,_props$initialModalSt14,_props$initialModalSt15,_props$initialModalSt16,_props$initialModalSt17,_props$initialModalSt18,_props$initialModalSt19,_props$initialModalSt20;return setPlaylistControlModalState(_objectSpread(_objectSpread({},playlistControlModalState),{},{nameTextFieldValue:(_props$initialModalSt11=(_props$initialModalSt12=props.initialModalState)===null||_props$initialModalSt12===void 0?void 0:_props$initialModalSt12.name)!==null&&_props$initialModalSt11!==void 0?_props$initialModalSt11:'',nameNotUsableReason:'',isAllowingDuplicate:(_props$initialModalSt13=(_props$initialModalSt14=props.initialModalState)===null||_props$initialModalSt14===void 0?void 0:_props$initialModalSt14.allow_duplicate)!==null&&_props$initialModalSt13!==void 0?_props$initialModalSt13:true,isPublicAccessable:(_props$initialModalSt15=(_props$initialModalSt16=props.initialModalState)===null||_props$initialModalSt16===void 0?void 0:_props$initialModalSt16.public_accessable)!==null&&_props$initialModalSt15!==void 0?_props$initialModalSt15:false,isPublicItemAppendable:(_props$initialModalSt17=(_props$initialModalSt18=props.initialModalState)===null||_props$initialModalSt18===void 0?void 0:_props$initialModalSt18.public_item_appendable)!==null&&_props$initialModalSt17!==void 0?_props$initialModalSt17:false,isPublicItemDeletable:(_props$initialModalSt19=(_props$initialModalSt20=props.initialModalState)===null||_props$initialModalSt20===void 0?void 0:_props$initialModalSt20.public_item_deletable)!==null&&_props$initialModalSt19!==void 0?_props$initialModalSt19:false,playlistCreationFailedReason:''}));},[props.initialModalState]);var currentStateToPlaylistConfig=function currentStateToPlaylistConfig(){return new PlaylistConfig({name:playlistControlModalState.nameTextFieldValue,allow_duplicate:playlistControlModalState.isAllowingDuplicate,public_accessable:playlistControlModalState.isPublicAccessable,public_item_appendable:playlistControlModalState.isPublicItemAppendable,public_item_deletable:playlistControlModalState.isPublicItemDeletable});};var closeModalFunc=function closeModalFunc(){if(!playlistControlModalState.isProcessing)props.setModalShowState(false);};var handleInputChange=function handleInputChange(valueName){return function(e){var newModalState=_objectSpread(_objectSpread({},playlistControlModalState),{},_defineProperty({},valueName,e.target.type==='checkbox'?e.target.checked:e.target.value));if(valueName==='nameTextFieldValue')newModalState.nameNotUsableReason='';setPlaylistControlModalState(newModalState);};};var tryPlaylistCreate=function tryPlaylistCreate(){var isRequestable=true;setPlaylistControlModalState(_objectSpread(_objectSpread({},playlistControlModalState),{},{isProcessing:true}));var newModalState=_objectSpread(_objectSpread({},playlistControlModalState),{},{isProcessing:true});// trim all strings in states\nfor(var key in newModalState){if(typeof newModalState[key]==='string')newModalState[key]=newModalState[key].trim();}if(!newModalState.nameTextFieldValue){newModalState.nameNotUsableReason='재생목록 이름을 적어주세요!';newModalState.isProcessing=false;isRequestable=false;}setPlaylistControlModalState(newModalState);if(isRequestable){PlayCoAPI.createPlaylist(currentStateToPlaylistConfig()).then(function(response){setPlaylistControlModalState(function(prevState){var _props$initialModalSt21,_props$initialModalSt22,_props$initialModalSt23,_props$initialModalSt24,_props$initialModalSt25,_props$initialModalSt26,_props$initialModalSt27,_props$initialModalSt28,_props$initialModalSt29,_props$initialModalSt30;return _objectSpread(_objectSpread({},prevState),{},{// Reset our modal\nnameTextFieldValue:(_props$initialModalSt21=(_props$initialModalSt22=props.initialModalState)===null||_props$initialModalSt22===void 0?void 0:_props$initialModalSt22.name)!==null&&_props$initialModalSt21!==void 0?_props$initialModalSt21:'',nameNotUsableReason:'',isAllowingDuplicate:(_props$initialModalSt23=(_props$initialModalSt24=props.initialModalState)===null||_props$initialModalSt24===void 0?void 0:_props$initialModalSt24.allow_duplicate)!==null&&_props$initialModalSt23!==void 0?_props$initialModalSt23:true,isPublicAccessable:(_props$initialModalSt25=(_props$initialModalSt26=props.initialModalState)===null||_props$initialModalSt26===void 0?void 0:_props$initialModalSt26.public_accessable)!==null&&_props$initialModalSt25!==void 0?_props$initialModalSt25:false,isPublicItemAppendable:(_props$initialModalSt27=(_props$initialModalSt28=props.initialModalState)===null||_props$initialModalSt28===void 0?void 0:_props$initialModalSt28.public_item_appendable)!==null&&_props$initialModalSt27!==void 0?_props$initialModalSt27:false,isPublicItemDeletable:(_props$initialModalSt29=(_props$initialModalSt30=props.initialModalState)===null||_props$initialModalSt30===void 0?void 0:_props$initialModalSt30.public_item_deletable)!==null&&_props$initialModalSt29!==void 0?_props$initialModalSt29:false,playlistCreationFailedReason:'',isProcessing:false});});closeModalFunc();},function(reason){setPlaylistControlModalState(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{playlistCreationFailedReason:reason.message,isProcessing:false});});});}};var tryPlaylistModify=function tryPlaylistModify(){var _props$initialModalSt31;if(!((_props$initialModalSt31=props.initialModalState)===null||_props$initialModalSt31===void 0?void 0:_props$initialModalSt31.uuid)){setPlaylistControlModalState(_objectSpread(_objectSpread({},playlistControlModalState),{},{playlistCreationFailedReason:'예상하지 못한 오류가 발생했어요, 새로고침을 해 주세요.'}));return;}setPlaylistControlModalState(_objectSpread(_objectSpread({},playlistControlModalState),{},{isProcessing:true}));PlayCoAPI.modifyPlaylist(props.initialModalState.uuid,currentStateToPlaylistConfig(),props.initialModalState.hash).then(function(result){setPlaylistControlModalState(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{isProcessing:false});});closeModalFunc();},function(reason){setPlaylistControlModalState(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{isProcessing:false,playlistCreationFailedReason:reason.message});});});};return/*#__PURE__*/_jsxs(Modal,{show:props.modalShowState,onHide:closeModalFunc,backdrop:\"static\",centered:true,children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsx(Modal.Title,{children:/*#__PURE__*/_jsx(\"h5\",{style:{margin:0},children:props.createMode?'재생목록 만들기':'재생목록 수정'})})}),/*#__PURE__*/_jsx(Modal.Body,{children:/*#__PURE__*/_jsxs(Form,{onSubmit:function onSubmit(evt){return evt.preventDefault();},children:[/*#__PURE__*/_jsxs(Form.Group,{children:[/*#__PURE__*/_jsx(Form.Label,{children:\"\\uC7AC\\uC0DD\\uBAA9\\uB85D \\uC774\\uB984\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:props.createMode?'여기에 새로 만드실 재생목록의 이름을 적어주세요':'여기에 이 재생목록의 새 이름을 적어주세요',disabled:playlistControlModalState.isProcessing,value:playlistControlModalState.nameTextFieldValue,onChange:handleInputChange('nameTextFieldValue')}),/*#__PURE__*/_jsx(PHFormText,{children:playlistControlModalState.nameNotUsableReason})]}),/*#__PURE__*/_jsxs(Form.Group,{children:[/*#__PURE__*/_jsx(Form.Label,{children:\"\\uC7AC\\uC0DD\\uBAA9\\uB85D \\uC124\\uC815\"}),/*#__PURE__*/_jsx(Form.Switch,{onChange:handleInputChange('isAllowingDuplicate'),checked:playlistControlModalState.isAllowingDuplicate,disabled:playlistControlModalState.isProcessing,id:\"isAllowingDuplicateSwitch\",label:\"\\uC911\\uBCF5\\uB418\\uB294 \\uC601\\uC0C1\\uC744 \\uCD94\\uAC00\\uD560 \\uC218 \".concat(playlistControlModalState.isAllowingDuplicate?'있어요':'없어요',\".\")}),/*#__PURE__*/_jsx(Form.Switch,{onChange:handleInputChange('isPublicAccessable'),checked:playlistControlModalState.isPublicAccessable,disabled:playlistControlModalState.isProcessing,id:\"isPublicAccessableSwitch\",label:\"\\uB2E4\\uB978 \\uC0AC\\uB78C\\uC774 \\uC7AC\\uC0DD\\uBAA9\\uB85D\\uC744 \\uBCFC \\uC218 \".concat(playlistControlModalState.isPublicAccessable?'있어요':'없어요',\".\")}),/*#__PURE__*/_jsx(Form.Switch,{onChange:handleInputChange('isPublicItemAppendable'),checked:playlistControlModalState.isPublicItemAppendable,disabled:playlistControlModalState.isProcessing,id:\"isPublicItemAppendableSwitch\",label:\"\\uB2E4\\uB978 \\uC0AC\\uB78C\\uC774 \\uC7AC\\uC0DD\\uBAA9\\uB85D\\uC5D0 \\uC601\\uC0C1\\uC744 \\uCD94\\uAC00\\uD560 \\uC218 \".concat(playlistControlModalState.isPublicItemAppendable?'있어요':'없어요',\".\")}),/*#__PURE__*/_jsx(Form.Switch,{onChange:handleInputChange('isPublicItemDeletable'),checked:playlistControlModalState.isPublicItemDeletable,disabled:playlistControlModalState.isProcessing,id:\"isPublicItemDeletableSwitch\",label:\"\\uB2E4\\uB978 \\uC0AC\\uB78C\\uC774 \\uC7AC\\uC0DD\\uBAA9\\uB85D\\uC5D0\\uC11C \\uC601\\uC0C1\\uC744 \\uC0AD\\uC81C\\uD560 \\uC218 \".concat(playlistControlModalState.isPublicItemDeletable?'있어요':'없어요',\".\")})]}),/*#__PURE__*/_jsx(PHFormText,{children:playlistControlModalState.playlistCreationFailedReason})]})}),/*#__PURE__*/_jsxs(Modal.Footer,{children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:closeModalFunc,disabled:playlistControlModalState.isProcessing,children:\"\\uCDE8\\uC18C\"}),/*#__PURE__*/_jsx(PHSpinnerButton,{variant:\"primary\",size:false,style:{margin:undefined},onClick:props.createMode?tryPlaylistCreate:tryPlaylistModify,showSpinner:playlistControlModalState.isProcessing,children:props.createMode?'재생목록 만들기':'재생목록 수정'})]})]});};","map":{"version":3,"sources":["C:/Users/MUsoftware/Desktop/project/MUsoftware/mudev.cc/src/ui/page/playco/element/playlistControlModal.tsx"],"names":["React","useState","useEffect","useNavigate","Form","Modal","Button","PHFormText","PHSpinnerButton","PlaylistConfig","PlayCoAPI","PlaylistControlModal","props","navigate","isProcessing","nameTextFieldValue","initialModalState","name","nameNotUsableReason","isAllowingDuplicate","allow_duplicate","isPublicAccessable","public_accessable","isPublicItemAppendable","public_item_appendable","isPublicItemDeletable","public_item_deletable","playlistCreationFailedReason","playlistControlModalState","setPlaylistControlModalState","currentStateToPlaylistConfig","closeModalFunc","setModalShowState","handleInputChange","valueName","e","newModalState","target","type","checked","value","tryPlaylistCreate","isRequestable","key","trim","createPlaylist","then","response","prevState","reason","message","tryPlaylistModify","uuid","modifyPlaylist","hash","result","modalShowState","margin","createMode","evt","preventDefault","undefined"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { Form, Modal, Button } from \"react-bootstrap\";\r\nimport { FrostError } from 'src/common/error';\r\n\r\nimport { PHFormText } from 'src/ui/common/element/muFormText';\r\nimport { PHSpinnerButton } from 'src/ui/common/element/muButton';\r\nimport { PlaylistConfig } from '../playco/model';\r\nimport { PlayCoAPI } from '../playco/api';\r\n\r\nexport const PlaylistControlModal: React.FC = (props: {\r\n  modalShowState: boolean;\r\n  setModalShowState: (boolean) => void;\r\n  createMode?: boolean;\r\n  initialModalState?: Playlist;\r\n}) => {\r\n  const navigate = useNavigate();\r\n  const [playlistControlModalState, setPlaylistControlModalState] = useState({\r\n    isProcessing: false,\r\n\r\n    nameTextFieldValue: props.initialModalState?.name ?? '',\r\n    nameNotUsableReason: '',\r\n    isAllowingDuplicate: props.initialModalState?.allow_duplicate ?? true,\r\n    isPublicAccessable: props.initialModalState?.public_accessable ?? false,\r\n    isPublicItemAppendable: props.initialModalState?.public_item_appendable ?? false,\r\n    isPublicItemDeletable: props.initialModalState?.public_item_deletable ?? false,\r\n    playlistCreationFailedReason: '',\r\n  });\r\n  useEffect(() => setPlaylistControlModalState({\r\n    ...playlistControlModalState,\r\n    nameTextFieldValue: props.initialModalState?.name ?? '',\r\n    nameNotUsableReason: '',\r\n    isAllowingDuplicate: props.initialModalState?.allow_duplicate ?? true,\r\n    isPublicAccessable: props.initialModalState?.public_accessable ?? false,\r\n    isPublicItemAppendable: props.initialModalState?.public_item_appendable ?? false,\r\n    isPublicItemDeletable: props.initialModalState?.public_item_deletable ?? false,\r\n    playlistCreationFailedReason: '',\r\n  }), [props.initialModalState]);\r\n  const currentStateToPlaylistConfig = () => new PlaylistConfig({\r\n    name: playlistControlModalState.nameTextFieldValue,\r\n    allow_duplicate: playlistControlModalState.isAllowingDuplicate,\r\n    public_accessable: playlistControlModalState.isPublicAccessable,\r\n    public_item_appendable: playlistControlModalState.isPublicItemAppendable,\r\n    public_item_deletable: playlistControlModalState.isPublicItemDeletable,\r\n  });\r\n  const closeModalFunc = () => {\r\n    if (!playlistControlModalState.isProcessing)\r\n      props.setModalShowState(false);\r\n  };\r\n  const handleInputChange = (valueName) => (e) => {\r\n    const newModalState = {\r\n      ...playlistControlModalState,\r\n      [valueName]: (e.target.type === 'checkbox') ? e.target.checked : e.target.value,\r\n    };\r\n    if (valueName === 'nameTextFieldValue')\r\n      newModalState.nameNotUsableReason = '';\r\n    setPlaylistControlModalState(newModalState);\r\n  }\r\n  const tryPlaylistCreate = () => {\r\n    let isRequestable = true;\r\n\r\n    setPlaylistControlModalState({\r\n      ...playlistControlModalState,\r\n      isProcessing: true,\r\n    });\r\n\r\n    const newModalState = {\r\n      ...playlistControlModalState,\r\n      isProcessing: true,\r\n    };\r\n    // trim all strings in states\r\n    for (const key in newModalState)\r\n      if (typeof (newModalState[key]) === 'string')\r\n        newModalState[key] = newModalState[key].trim();\r\n\r\n    if (!newModalState.nameTextFieldValue) {\r\n      newModalState.nameNotUsableReason = '재생목록 이름을 적어주세요!';\r\n      newModalState.isProcessing = false;\r\n      isRequestable = false;\r\n    }\r\n    setPlaylistControlModalState(newModalState);\r\n\r\n    if (isRequestable) {\r\n      PlayCoAPI\r\n        .createPlaylist(currentStateToPlaylistConfig())\r\n        .then(\r\n          (response) => {\r\n            setPlaylistControlModalState((prevState) => ({\r\n              ...prevState,\r\n\r\n              // Reset our modal\r\n              nameTextFieldValue: props.initialModalState?.name ?? '',\r\n              nameNotUsableReason: '',\r\n              isAllowingDuplicate: props.initialModalState?.allow_duplicate ?? true,\r\n              isPublicAccessable: props.initialModalState?.public_accessable ?? false,\r\n              isPublicItemAppendable: props.initialModalState?.public_item_appendable ?? false,\r\n              isPublicItemDeletable: props.initialModalState?.public_item_deletable ?? false,\r\n              playlistCreationFailedReason: '',\r\n              isProcessing: false,\r\n            }));\r\n            closeModalFunc();\r\n          },\r\n          (reason: FrostError) => {\r\n            setPlaylistControlModalState((prevState) => ({\r\n              ...prevState,\r\n              playlistCreationFailedReason: reason.message,\r\n              isProcessing: false,\r\n            }));\r\n          });\r\n    }\r\n  }\r\n  const tryPlaylistModify = () => {\r\n    if (!props.initialModalState?.uuid) {\r\n      setPlaylistControlModalState({\r\n        ...playlistControlModalState,\r\n        playlistCreationFailedReason: '예상하지 못한 오류가 발생했어요, 새로고침을 해 주세요.',\r\n      });\r\n      return;\r\n    }\r\n\r\n    setPlaylistControlModalState({\r\n      ...playlistControlModalState,\r\n      isProcessing: true,\r\n    })\r\n\r\n    PlayCoAPI\r\n      .modifyPlaylist(\r\n        props.initialModalState.uuid,\r\n        currentStateToPlaylistConfig(),\r\n        props.initialModalState.hash)\r\n      .then(\r\n        (result) => {\r\n          setPlaylistControlModalState((prevState) => ({\r\n            ...prevState,\r\n            isProcessing: false,\r\n          }));\r\n          closeModalFunc();\r\n        },\r\n        (reason: FrostError) => {\r\n          setPlaylistControlModalState((prevState) => ({\r\n            ...prevState,\r\n            isProcessing: false,\r\n            playlistCreationFailedReason: reason.message,\r\n          }));\r\n        },\r\n      );\r\n  }\r\n\r\n  return <Modal\r\n    show={props.modalShowState}\r\n    onHide={closeModalFunc}\r\n    backdrop='static'\r\n    centered >\r\n    <Modal.Header closeButton>\r\n      <Modal.Title>\r\n        <h5 style={{ margin: 0, }}>\r\n          {(props.createMode) ? '재생목록 만들기' : '재생목록 수정'}\r\n        </h5>\r\n      </Modal.Title>\r\n    </Modal.Header>\r\n    <Modal.Body>\r\n      <Form onSubmit={evt => evt.preventDefault()}>\r\n        <Form.Group>\r\n          <Form.Label>재생목록 이름</Form.Label>\r\n          <Form.Control\r\n            type='text'\r\n            placeholder={\r\n              (props.createMode)\r\n                ? '여기에 새로 만드실 재생목록의 이름을 적어주세요'\r\n                : '여기에 이 재생목록의 새 이름을 적어주세요'\r\n            }\r\n            disabled={playlistControlModalState.isProcessing}\r\n            value={playlistControlModalState.nameTextFieldValue}\r\n            onChange={handleInputChange('nameTextFieldValue')} />\r\n          <PHFormText>{playlistControlModalState.nameNotUsableReason}</PHFormText>\r\n        </Form.Group>\r\n        <Form.Group>\r\n          <Form.Label>재생목록 설정</Form.Label>\r\n          <Form.Switch\r\n            onChange={handleInputChange('isAllowingDuplicate')}\r\n            checked={playlistControlModalState.isAllowingDuplicate}\r\n            disabled={playlistControlModalState.isProcessing}\r\n            id='isAllowingDuplicateSwitch'\r\n            label={`중복되는 영상을 추가할 수 ${(playlistControlModalState.isAllowingDuplicate) ? '있어요' : '없어요'}.`} />\r\n          <Form.Switch\r\n            onChange={handleInputChange('isPublicAccessable')}\r\n            checked={playlistControlModalState.isPublicAccessable}\r\n            disabled={playlistControlModalState.isProcessing}\r\n            id='isPublicAccessableSwitch'\r\n            label={`다른 사람이 재생목록을 볼 수 ${(playlistControlModalState.isPublicAccessable) ? '있어요' : '없어요'}.`} />\r\n          <Form.Switch\r\n            onChange={handleInputChange('isPublicItemAppendable')}\r\n            checked={playlistControlModalState.isPublicItemAppendable}\r\n            disabled={playlistControlModalState.isProcessing}\r\n            id='isPublicItemAppendableSwitch'\r\n            label={`다른 사람이 재생목록에 영상을 추가할 수 ${(playlistControlModalState.isPublicItemAppendable) ? '있어요' : '없어요'}.`} />\r\n          <Form.Switch\r\n            onChange={handleInputChange('isPublicItemDeletable')}\r\n            checked={playlistControlModalState.isPublicItemDeletable}\r\n            disabled={playlistControlModalState.isProcessing}\r\n            id='isPublicItemDeletableSwitch'\r\n            label={`다른 사람이 재생목록에서 영상을 삭제할 수 ${(playlistControlModalState.isPublicItemDeletable) ? '있어요' : '없어요'}.`} />\r\n        </Form.Group>\r\n        <PHFormText>{playlistControlModalState.playlistCreationFailedReason}</PHFormText>\r\n      </Form>\r\n    </Modal.Body>\r\n    <Modal.Footer>\r\n      <Button\r\n        variant='secondary'\r\n        onClick={closeModalFunc}\r\n        disabled={playlistControlModalState.isProcessing}>\r\n        취소\r\n      </Button>\r\n\r\n      <PHSpinnerButton\r\n        variant='primary'\r\n        size={false}\r\n        style={{ margin: undefined }}\r\n        onClick={(props.createMode) ? tryPlaylistCreate : tryPlaylistModify}\r\n        showSpinner={playlistControlModalState.isProcessing}>\r\n        {(props.createMode) ? '재생목록 만들기' : '재생목록 수정'}\r\n      </PHSpinnerButton>\r\n    </Modal.Footer>\r\n  </Modal>;\r\n}\r\n"]},"metadata":{},"sourceType":"module"}